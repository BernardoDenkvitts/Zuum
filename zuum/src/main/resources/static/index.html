<!DOCTYPE html>
<html>
<head>
    <title>Hello WebSocket</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.2/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>

<script>
    window.addEventListener('load', (e) => {
    const socket = new SockJS('http://localhost:8080/ws/zuum')
    const stomp = Stomp.over(socket)
    
    // Receive ride requests in real time:
    stomp.connect({Authorization: '22'}, (frame) => { 
        stomp.subscribe('/user/queue/ride-accepted', (message) => {
            console.log('Nova ride rquest: ' + message.body);
        });
    })
    
    // const stompLocation = Stomp.over(socket)
    // stompLocation.connect({ Authorization: '14' }, (frame) => {
    //    stompLocation.subscribe('/user/queue/reply', (message) => {
    //         console.log('Message received: ' + message.body);
    //     });
    //    const sendLocationUpdate = (driverId, latitude, longitude) => {
    //         const locationDTO = {
    //             driver_id: driverId,
    //             curr_location: {
    //                 x: latitude,
    //                 y: longitude
    //             }
    //         };

    //         stompLocation.send('/ws/zuum/location', {}, JSON.stringify(locationDTO));
    //     };

    //     sendLocationUpdate(1, -15.55052, -70.633308);

    // Receive ride requests in real time:
    stomp.connect({Authorization: '22'}, (frame) => {
        stomp.subscribe('/user/queue/ride-accepted', (message) => {
            console.log('Driver accepted the ride request: ' + message.body);
        });
    })

    });
</script>
</body>
</html>