<!DOCTYPE html>
<html>
<head>
    <title>Hello WebSocket</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.2/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>

<script>
    window.addEventListener('load', (e) => {
        const socketPassanger = new SockJS('http://localhost:8080/ws/zuum')
        const socketDriver = new SockJS('http://localhost:8080/ws/zuum')
        const stomp = Stomp.over(socketPassanger)

        const stompDriver = Stomp.over(socketDriver)
        stompDriver.connect({ Authorization: '14' }, (frame) => {

            stompDriver.subscribe('/user/queue/ride-request', (message) => {
                console.log('New ride request: ' + message.body);
            })
        
            stompDriver.subscribe('/user/queue/reply', (message) => {
                console.log('Message received: ' + message.body);
            })
        })

        //    const sendLocationUpdate = (driverId, latitude, longitude) => {
        //         const locationDTO = {
        //             driver_id: driverId,
        //             curr_location: {
        //                 x: latitude,
        //                 y: longitude
        //             }
        //         };

        //         stompLocation.send('/ws/zuum/location', {}, JSON.stringify(locationDTO));
        //     };

        //     sendLocationUpdate(1, -15.55052, -70.633308);

        stomp.connect({Authorization: '20'}, (frame) => {
            stomp.subscribe('/user/queue/ride-status', (message) => {
                console.log('Your ride status was updated: ' + message.body);
            });
        })

    });
</script>
</body>
</html>